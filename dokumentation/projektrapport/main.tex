\documentclass[a4paper]{article}

\usepackage[swedish]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{titlesec}
\usepackage{graphicx}
\usepackage{float}

\newcommand{\namn}{Larmsystem}
\newcommand{\todo}[1]{\marginpar{TODO: #1}\vspace{1cm}}
\newcommand{\comment}[1]{\marginpar{Comment: #1}}

\newcommand{\subsubsubsection}[1]{\paragraph{#1}\mbox{}\\}
\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{4}

\restylefloat{table}

\begin{document}
\begin{center}
    \parskip=14pt
    \vspace*{3\parskip}

    {\LARGE Projektrapport DAT290}

    {\large \namn, grupp 11

    Titus Blosse, Viktor Frideen, Nazif Kadiroglu, Markus Moen, Lukas Schiavone, Fredrik Österström

    \today}

    \rule{7cm}{0.4pt}\\
\end{center}
\thispagestyle{empty}
\newpage

\tableofcontents
\thispagestyle{empty}
\newpage

\section*{Ordlista}

\begin{description}
    \item[CAN:] Controller Area Network
    \item[IDE:] Integrated Development Environment
    \item[MD407:] Mikrodator av typen MD407
\end{description}
\thispagestyle{empty}
\newpage

\pagenumbering{arabic}

\section{Inledning}
\todo{Gärna lite text här}

\subsection{Syfte}
Inbrott är ett vanligt problem i Sverige.
År 2019 anmäldes 75.250 inbrottstölder.
En minskning med 14\% från året innan \cite{brastold}.
Vanliga sätt att förhindra inbrott är grannsamverkan, certifierade lås mot inbrott och hemlarm.
Larmsystem minskar risken för ett inbrott och möjliggör ytterligare minskning både i Sverige och i resten av världen.

\subsection{Mål}

Produkten ska erbjuda ett flertal larmkomponenter som kan anslutas till en larmcentral och konfigureras för att passa kundens specifika situation.
Systemet ska vara dokumenterat och fackmannamässigt utfört med förutsättningar för expansion.

Grunden i systemet kommer vara en centralenhet till vilken användaren kan ansluta periferienheter.
Huvudsakligen kommer två periferienheter att utvecklas, ett dörrlarm och ett rörelselarm.

I mån av tid kommer extra funktionalitet implementeras.
Denna extra funktionalitet är ett testläge för pereferienheterna, ett lokalt larm för rörelsesensorn, och ett inbyggt skydd mot ''replay attacker''.

\subsection{Bakgrund}

Beståndsdelarna i larmsystemet är en centralenhet och periferienheter.
Komponenterna skapar tillsammans möjligheten att till exempel, larma på/av, koppla samman enheter eller inställning av befintliga enheter.
Koppling sker via instruktioner som kan skickas både manuellt eller automatiskt via en av komponenterna.

\subsection{Arbetsmetod}

Mjukvaran för projektet är skriven i programspråket C.
C är ett lågnivå-programmeringsspråk vilket är lämpligt för utveckling av mjukvara till mikrodatorn MD407.
Utvecklingen av mjukvaran har skett i CodeLite som är ett IDE (Integrated Development Environment).
%CodeLite användes då gruppmeddlemmarna sedan tidagare har erfarenhet med IDE:n samt att den lämpar sig bra för utveckling mot MD407.

Versionshantering har gjorts med hjälp av git.
Ett gemensamt repository skapades på GitHub där all kod för projektet samlades.

Majoriteten av testningen utfördes direkt på hårdvaran i Chalmers lokaler.
Viss testning har genomförts med hjälp av mjukvaran SimServer som tillåter simulering av MD407-kortet.
Funktionaliteten hos SimServer är dock begränsad därför har den största delen av testningen behövts utföras i Chalmers laborationssalar.

Arbetsgruppen delades inledningsvis upp i tre undergrupper som ansvarade över olika delar av utvecklingen.
Därefter utvecklade undergrupperna mjukvaran som var grunden för deras specifika område för att sedan i små steg utöka funktionaliteten.
Under utvecklingens gång suddades gränserna mellan grupperna ut då dom separata mjukvarorna integrerades och gemensamt arbete blev fördelaktigt.


\section{Teknisk Beskrivning}
I detta avsnitt ges en inblick i hur systemet fungerar och hänger ihop.
Den mjukvara och hårdvara som projektet baseras på beskrivs även i mer detalj.

\subsection{Teknisk Bakgrund}
Hårdvaran vilket system körs på är en MD407 mikrodator.
All mjukvara är skriven i programspårket C.
MD407 har begränsat med minne vilket gör att programmen som skrivs för den måste vara små och effektiva.
C är ett lågt programspråk vilket medför att programmeraren har stor kontroll över minneshanteringen i programmet.
C lämpar sig alltså väl för utveckling mot MD407.

Systemet kretsar kring att flera MD407 sammankopplas, en MD407 agerar då som centralenhet och resterande används för att ansluta periferienheter så som dörrlarm och rörelsesensorer.
MD407-korten kommunicerar via ett protokoll som baserats på CAN (Controllerar Area Network).
CAN är ett färdigutvecklat protokoll för kommunikation mellan datorer.
Ett kommunikationsprotokoll har sedan byggts uppepå CAN som är anpassat för systemet.

\subsection{Systemöversikt}

Ett MD407-kort väljs som centralenhet.
Centralenhetens uppgift är att kommunicera med periferienheterna och att administrera alarm.
En periferienhet kan initialiseras med typen dörr eller rörelse.

\subsubsection{CAN}
CAN är det gemensamma protokollet som både periferienhet och centralenhet måste förstå.
Koden är därför strukturerad så att samma kod kan köras på valfri enhet oavsett typ.
CAN ansvarar för att meddelanden kan skickas och de hanteras.
Med hjälp av riktning och ID kan alla enheter ta emot och skicka meddelanden till godtycklig mottagare.

\subsubsection{Centralenhet}
Centralenheten lyssnar efter meddelanden kontinuerligt.
Ett meddelande kan till exempel innefatta ett alarm, ny enhet eller att det uppstått ett fel.
Den anvarar även för förfrågningar till periferienheterna för att undersöka att inget kopplats bort.
Vid alarm så registrerar centralenheten det och avaktiverar endast alarmet om rätt kod är inmatad på tangentbordet.

\subsubsection{Periferienhet}
Periferienheterna avlyssnar sina sensorer och rapporterar ett alarm till centralenheten om tröskeln för sensortypen är överskriden.
För att inte centralenheten ska initiera ett alarm måste periferienheterna kunna svara på dess förfrågan.
När periferienheten initialiseras hämtas en identifierare från centralenheten via CAN.

\subsubsubsection{Dörrsensor}
Dörrsensorns uppgift är att upptäcka om en dörr är öppen eller stängd.
Värdet på sensorn läses av från PE0 som är konfigurerad med en Pull-Up-resistor.
Vid öppnad dörr bryts kretsen och det logiska värdet blir ett.
Vid sluten krets är det logiska värdet på kretsen noll.

\subsubsubsection{Rörelsesensor}
Rörelsesensorn uppgift är att upptäcka skillnader i avstånd.
För att kunna läsa ett värde från sensorn måste en logisk etta skrivas till trig-pinnen i minst 10 \textmu s.
Sensorn svarar med att skriva en logisk etta på echo-pinnen.
Längden av denna logiska etta motsvarar det uppmätta avståndet.

\section{Resultat}

\section{Slutsatser}


\bibliographystyle{IEEEtran}
\bibliography{referenser.bib}

\end{document}
